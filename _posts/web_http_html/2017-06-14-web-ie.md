---
layout: post
title: IE 兼容性 
category: web
comments: false
--- 
浏览器分两种，一种是IE，一种是其他浏览器。

在开发中，经常遇到浏览器兼容性问题，而这些问题几乎都和IE有关。本来是一段非常简洁高效的代码，可就为了兼容『高贵的』IE，要变得又丑又长。作为浏览器界拖后腿的存在，IE算是很成功的。

本文记录一些坑，以及填坑方式。

## 1. IE低版本(<=8)不兼容 JSON.parse
IE8及以下的内核不支持通过JSON.parse将字符串转换成JSON对象，下面是替代方法：

1. eval方式解析，恐怕这是最早的解析方式了

    function strToJson(str){ 
    var json = eval('(' + str + ')'); 
    return json; 
    } 

2. new Function形式，比较怪异。如下 

    function strToJson(str){ 
    var json = (new Function("return " + str))(); 
    return json; 
    } 

## 2. 低版本出现getElementById()获取对象为undefined的问题
原因在于网页中的javaScript脚本代码往往需要在文档加载完成后才能够去执行，否则可能导致无法获取对象的情况。

为了避免这种情况的发生，可以使用以下两种方式:

1. 将脚本代码放在网页的底端，这样在运行脚本代码的时候，可以确保要操作的对象已经加载完成。
2. 通过window.onload来执行脚本代码。

建议用第二种方式。 示例代码：

    <script type="text/javascript">
        window.onload=function(){
          document.getElementById("bg").style.backgroundColor="#F90";
        }
    </script>

## 3. 强制使用某种模式去解析网页代码 （待亲测）

    <meta http-equiv=“X-UA-Compatible” content=“IE=EmulateIE7″> //或 IE=7
    <meta http-equiv=“X-UA-Compatible” content=“IE=8″> // 强制使用IE8模式
